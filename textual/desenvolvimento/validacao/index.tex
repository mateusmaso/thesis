\section{Validação}

Com o objetivo de validar o modelo proposto através da ferramenta desenvolvida para plataforma web, é feito uma pesquisa comparativa focando o impacto do seu uso em relação à mudanças no fluxo de dados. Para isso será desenvolvido um ambiente de validação onde dois clientes, um com a ferramenta e o outro não, realizam três consultas na API de um serviço REST. Após, será aplicado uma série de mudanças no fluxo de dados da API REST e coletado os dados para análise do impacto causado no código de busca desses clientes. \\

\textbf{Escopo de serviço} \\

Foi escolhido trabalhar com um escopo de serviço SWAPI (Starwars), bastante utilizado para análise de implementações de tecnologias e estilos de arquitetura em diversas linguagens de programação. Nele, são descritos seis entidades (Pessoa, Filme, Espaçonave, Veículo, Espécie, Planeta) e seus respectivos relacionamentos. Na tabela 6, é descrito os pontos de acesso da API REST (SWAPI) utilizada na validação. Nota-se que todos os pontos de acesso não retornam seus relacionamentos expandidos, ou seja, seu nível de expansão é zero.

\begin{table}[H]
  \centering
  \begin{tabular}{|l|c|}
    \hline
    URI & Descrição \\
    \hline
    /people & Busca lista de pessoas \\
    \hline
    /people/:id & Busca pessoa pelo id \\
    \hline
    /films & Busca lista de filmes \\
    \hline
    /films/:id & Busca filme pelo id \\
    \hline
    /starships & Busca lista de espaçonaves \\
    \hline
    /starships/:id & Busca espaçonave pelo id \\
    \hline
    /vehicles & Busca lista de veículos \\
    \hline
    /vehicles/:id & Busca veículo pelo id \\
    \hline
    /species & Busca lista de espécies \\
    \hline
    /species/:id & Busca espécie pelo id \\
    \hline
    /planets & Busca lista de planetas \\
    \hline
    /planets/:id & Busca planeta pelo id \\
    \hline
  \end{tabular}
  \caption{Pontos de acesso SWAPI para busca de dados}
\end{table}

\textbf{Perguntas e respostas esperadas} \\

Com o propósito de explorar cada ponto de acesso para busca de dados na SWAPI, foram pensadas em três perguntas de média complexidade e onde fossem envolvidos ao menos três das entidades para consulta na API. Para cada pergunta existe apenas uma resposta certa, onde sua lógica é baseada em campos das estruturas de dados de retorno nos pontos de acesso.

\begin{enumerate}
\item[\textbf{Q1.}] Qual o nome do filme no qual aparece mais personagens oriundos de um planeta deserto? \textbf{R:} "Revenge of the Sith"
\item[\textbf{Q2.}] Qual o nome da espécie predominante entre os habitantes do planeta "Tatooine"? \textbf{R:} "Droid"
\item[\textbf{Q3.}] Qual o nome do personagem que mais pilota espaçonaves e veículos durante o filme "A New Hope"? \textbf{R:} "Chewbacca"
\end{enumerate}

Falar sobre como é feito o fluxo de dados para acesso das informações.

\begin{table}[H]
  \centering
  \begin{tabular}{|c|c|c|}
    \hline
    Pergunta & Fluxo de Dados & Número de requisições \\
    \hline
    Q1 & \begin{minipage}[t]{0.3\textwidth}
      \begin{itemize}
        \item[\textbf{GET}] /api/films
        \item[\textbf{GET}] /api/people/:id
        \item[\textbf{GET}] /api/planet/:id
      \end{itemize}
    \end{minipage} & \begin{minipage}[t]{0.5\textwidth}
      \begin{itemize}
        \item[\textbf{x1}] films
        \item[\textbf{x162}] films.characters
        \item[\textbf{x162}] films.characters.homeworld
      \end{itemize}
    \end{minipage} \\
    \hline
    Q2 & \begin{minipage}[t]{0.3\textwidth}
      \begin{itemize}
        \item[\textbf{GET}] /api/planets/1
        \item[\textbf{GET}] /api/people/:id
        \item[\textbf{GET}] /api/species/:id
      \end{itemize}
    \end{minipage} & \begin{minipage}[t]{0.5\textwidth}
      \begin{itemize}
        \item[\textbf{x1}] planet
        \item[\textbf{x10}] planet.residents
        \item[\textbf{x2}] planet.residents.species
      \end{itemize}
    \end{minipage} \\
    \hline
    Q3 & \begin{minipage}[t]{0.3\textwidth}
      \begin{itemize}
        \item[\textbf{GET}] /api/films/1
        \item[\textbf{GET}] /api/starships/:id
        \item[\textbf{GET}] /api/people/:id
        \item[\textbf{GET}] /api/vehicles/:id
        \item[\textbf{GET}] /api/people/:id
      \end{itemize}
    \end{minipage} & \begin{minipage}[t]{0.5\textwidth}
      \begin{itemize}
        \item[\textbf{x1}] film
        \item[\textbf{x8}] film.starships
        \item[\textbf{x9}] film.starships.pilots
        \item[\textbf{x4}] film.vehicles
        \item[\textbf{x0}] film.vehicles.pilots
      \end{itemize}
    \end{minipage} \\
    \hline
  \end{tabular}
  \caption{Fluxo de dados para responder as perguntas}
\end{table}

\textbf{Mudanças no fluxo de dados} \\

É proposto quatro tipos de mudanças no fluxo de dados para quebra de contrato, onde cada mudança testa a capacidade da ferramenta em a adaptar a comunicação através da atualização dos metadados do serviço.

\begin{enumerate}
\item[\textbf{C1.}] Mudança no endereço de ponto de acesso.
\item[\textbf{C2.}] Mudança no nível de estrutura de resposta.
\item[\textbf{C3.}] Adição de ponto de acesso otimizado.
\item[\textbf{C4.}] Remoção de ponto de acesso deprecado.
\end{enumerate}

Falar sobre as alterações no fluxo de dados mais em detalhe.

\begin{table}[H]
  \centering
  \begin{tabular}{|c|c|}
    \hline
    Mudança & Descrição \\
    \hline
    C1 & \begin{minipage}[t]{0.8\textwidth}
      \begin{itemize}
        \item Renomeação da URI /films para /movies.
        \item Renomeação da URI /films/:id para /movies/:id
      \end{itemize}
    \end{minipage} \\
    \hline
    C2 & \begin{minipage}[t]{0.8\textwidth}
      \begin{itemize}
        \item Expansão do campo pilots da URI /starships/:id
        \item Expansão do campo pilots da URI /vehicles/:id
      \end{itemize}
    \end{minipage} \\
    \hline
    C3 & \begin{minipage}[t]{0.8\textwidth}
      \begin{itemize}
        \item[\textbf{+}] Adição da URI /tatooine.
        \item[\textbf{+}] Adição da URI /films/:id/characters.
      \end{itemize}
    \end{minipage} \\
    \hline
    C4 & \begin{minipage}[t]{0.8\textwidth}
      \begin{itemize}
        \item[\textbf{+}] Adição da URI /people/:id/homeworld.
        \item[\textbf{$-$}] Remoção da URI /planet/:id.
      \end{itemize}
    \end{minipage} \\
    \hline
  \end{tabular}
  \caption{Changelog das alterações no fluxo de dados}
\end{table}

\begin{table}[H]
  \centering
  \begin{tabular}{|c|c|c|c|}
    \hline
    Mudança & Q1 & Q2 & Q3 \\
    \hline
    C1 & \begin{minipage}[t]{0.3\textwidth}
      \begin{itemize}
        \item[\textbf{GET}] /api/movies
        \item[\textbf{GET}] /api/people/:id
        \item[\textbf{GET}] /api/planet/:id
      \end{itemize}
    \end{minipage} & \begin{minipage}[t]{0.3\textwidth}
      \begin{itemize}
        \item[\textbf{GET}] /api/planets/1
        \item[\textbf{GET}] /api/people/:id
        \item[\textbf{GET}] /api/species/:id
      \end{itemize}
    \end{minipage} & \begin{minipage}[t]{0.3\textwidth}
      \begin{itemize}
        \item[\textbf{GET}] /api/movies/1
        \item[\textbf{GET}] /api/starships/:id
        \item[\textbf{GET}] /api/people/:id
        \item[\textbf{GET}] /api/vehicles/:id
        \item[\textbf{GET}] /api/people/:id
      \end{itemize}
    \end{minipage} \\
    \hline
    C2 & \begin{minipage}[t]{0.3\textwidth}
      \begin{itemize}
        \item[\textbf{GET}] /api/films
        \item[\textbf{GET}] /api/people/:id
        \item[\textbf{GET}] /api/planet/:id
      \end{itemize}
    \end{minipage} & \begin{minipage}[t]{0.3\textwidth}
      \begin{itemize}
        \item[\textbf{GET}] /api/planets/1
        \item[\textbf{GET}] /api/people/:id
        \item[\textbf{GET}] /api/species/:id
      \end{itemize}
    \end{minipage} & \begin{minipage}[t]{0.3\textwidth}
      \begin{itemize}
        \item[\textbf{GET}] /api/films/1
        \item[\textbf{GET}] /api/starships/:id
        \item[\textbf{GET}] /api/vehicles/:id
      \end{itemize}
    \end{minipage} \\
    \hline
    C3 & \begin{minipage}[t]{0.3\textwidth}
      \begin{itemize}
        \item[\textbf{GET}] /api/films
        \item[\textbf{GET}] /api/films/:id/characters
        \item[\textbf{GET}] /api/planet/:id
      \end{itemize}
    \end{minipage} & \begin{minipage}[t]{0.3\textwidth}
      \begin{itemize}
        \item[\textbf{GET}] /api/tatooine
        \item[\textbf{GET}] /api/species/:id
      \end{itemize}
    \end{minipage} & \begin{minipage}[t]{0.3\textwidth}
      \begin{itemize}
        \item[\textbf{GET}] /api/films/1
        \item[\textbf{GET}] /api/starships/:id
        \item[\textbf{GET}] /api/people/:id
        \item[\textbf{GET}] /api/vehicles/:id
        \item[\textbf{GET}] /api/people/:id
      \end{itemize}
    \end{minipage} \\
    \hline
    C4 & \begin{minipage}[t]{0.3\textwidth}
      \begin{itemize}
        \item[\textbf{GET}] /api/films
        \item[\textbf{GET}] /api/people/:id
        \item[\textbf{GET}] /api/people/:id/homeworld
      \end{itemize}
    \end{minipage} & - & \begin{minipage}[t]{0.3\textwidth}
      \begin{itemize}
        \item[\textbf{GET}] /api/films/1
        \item[\textbf{GET}] /api/starships/:id
        \item[\textbf{GET}] /api/people/:id
        \item[\textbf{GET}] /api/vehicles/:id
        \item[\textbf{GET}] /api/people/:id
      \end{itemize}
    \end{minipage} \\
    \hline
  \end{tabular}
  \caption{Novo fluxo de dados para cada mudança}
\end{table}

\textbf{Consultas no intermediador} \\

\begin{table}[H]
  \centering
  \begin{tabular}{|c|c|}
    \hline
    Pergunta & Consulta GraphQL \\
    \hline
    Q1 & \begin{minipage}[t]{0.5\textwidth}
      \begin{minted}{text}
      {
        allFilms {
          title
          characters {
            homeworld {
              climate
            }
          }
        }
      }
      \end{minted}
    \end{minipage} \\
    \hline
    Q2 & \begin{minipage}[t]{0.5\textwidth}
      \begin{minted}{text}
      {
        planet(planetID: 1) {
          residents {
            species {
              name
            }
          }
        }
      }
      \end{minted}
    \end{minipage} \\
    \hline
    Q3 & \begin{minipage}[t]{0.5\textwidth}
      \begin{minted}{text}
      {
        film(filmID: 1) {
          starships {
            pilots {
              name
            }
          }
          vehicles {
            pilots {
              name
            }
          }
        }
      }
      \end{minted}
    \end{minipage} \\
    \hline
  \end{tabular}
  \caption{Consultas GraphQL para as perguntas}
\end{table}

\textbf{Variáveis} \\

É descrito cinco variáveis para análise dos testes de validação. Todos são quantitativas e coletadas no cliente após cada processo de mudança da API. Totalizando um número de 20 dados possíveis para análise no final de sua execução.

\begin{table}[H]
  \centering
  \begin{tabular}{|c|c|c|}
    \hline
    Variável & Unidade & Tipo \\
    \hline
    Porcentagem de acerto & \% & Quantitativa \\
    \hline
    Tamanho de resposta & kb & Quantitativa \\
    \hline
    Número de requisições & inteiro & Quantitativa \\
    \hline
    Tempo de busca de metadados & ms & Quantitativa \\
    \hline
    Tempo de processamento & ms & Quantitativa \\
    \hline
  \end{tabular}
  \caption{Variáveis de coleta e análise}
\end{table}

 
 
 
 
 
 

 
