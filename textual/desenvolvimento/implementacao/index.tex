\section{Implementação}

A fim de aplicar a especificação da ferramenta baseado no modelo proposto no planejamento de projeto, foram implementados um total de dez funções para o uso de clientes na plataforma web. Dentre as funções, quatro delas são responsáveis por criar o intermediador gerando um esquema GraphQL. Três para analisar as consultas através do formato AST e outras três para transformar as consultas em requisições na API de serviços. 

Nota-se que, apenas quatro dessas dez funções são públicas e expostas para o cliente. Sendo uma delas (composeSchema) a principal para configuração/uso da ferramenta e, as outras três (buildSchema, transformAST, fetchData), para uso interno de adaptadores. A seguir, é descrito brevemente as 3 categorias de funções, junto com seu objetivo e a assinatura de cada método escrito em JavaScript. \\

\textbf{Funções para criação do esquema} \\

Representam quatro funções e seu principal objetivo é compor, de forma assíncrona, um esquema GraphQL unificado a partir das funcões de configuração de cada serviço.

\begin{figure}[H]
  \centering
  \begin{minted}[frame=single,framesep=10pt,fontsize=\footnotesize]{text}
  function composeSchema(
    services: [Service]
  ): Promise<GraphQLSchema>

  function buildSchema(
    schema: JSON
  ): Promise<GraphQLSchema>

  function wrapSchema(
    schema: GraphQLSchema, 
    wrapper: Wrapper
  ): Promise<GraphQLSchema>

  function deepExtendSchema(
    schemas: [GraphQLSchema]
  ): Promise<GraphQLSchema>
  \end{minted}
  \caption{Assinatura das funções para criação do esquema}
\end{figure}

\textbf{Funções para análise de consulta} \\

São três funções que buscam analisar consultas GraphQL feitas no esquema gerado em formato AST. A análise descreve algoritmos que simplificam, transformam e reduzem o AST principal da consulta, quebrando em ASTs específicos para cada serviço.

\begin{figure}[H]
  \centering
  \begin{minted}[frame=single,framesep=10pt,fontsize=\footnotesize]{text}
  function simplifyAST(
    value: AST, 
    info: JSON
  ): SimplifiedAST

  function transformAST(
    schema: JSON,
    clientSchema: GraphQLSchema, 
    ast: SimplifiedAST
  ): SimplifiedAST

  function reduceASTs(
    rootAST: SimplifiedAST, 
    asts: [SimplifiedAST]
  ): void
  \end{minted}
  \caption{Assinatura das funções para análise de consulta}
\end{figure}

\textbf{Funções para busca de dados} \\

São as três últimas funções responsáveis por converter os ASTs de cada serviço e realizar as respectivas requisições para a API em busca de dados.

\begin{figure}[H]
  \centering
  \begin{minted}[frame=single,framesep=10pt,fontsize=\footnotesize]{text}
  function unwrapAST(
    ast: SimplifiedAST, 
    schema: GraphQLSchema, 
    wrapper: Wrapper
  ): SimplifiedAST

  function fetchData(
    schema: JSON, 
    ast: SimplifiedAST, 
    url: string
  ): Promise<JSON>

  function wrapData(
    data: JSON, 
    schema: JSON, 
    wrapper: Wrapper
  ): Promise<JSON>
  \end{minted}
  \caption{Assinatura das funções para busca de dados}
\end{figure}
